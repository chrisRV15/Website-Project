<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pet Gallery</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <style>
    </style>
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

    <nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand" href="PetGallery.html">Pet Gallery</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav" >
        <a class="nav-link active" aria-current="page" href="Home.html">My Home</a>
        <a class="nav-link active" href="Gallery.html">Gallery</a>
      </div>
    </div>
    </div>
    </nav>

    <form>
      <label for="file-upload">Choose the image that you want upload:</label>
      <input type="file" id="img-upload" accept="image/jpeg, image/png, image/jpg">
      <button type="submit" id="upload-btn">Upload image</button>
    </form>
    <br>
    <div id="image-gallery"></div>

    <script>
      const imgUpload = document.getElementById("img-upload");
      const uploadBtn = document.getElementById("upload-btn");
      const galleryDiv = document.getElementById("image-gallery");
      const images = JSON.parse(localStorage.getItem("images")) || [];


uploadBtn.addEventListener("click", () => {

    const file = imgUpload.files[0];

    if(file){
        const reader = new FileReader();

        reader.addEventListener("load",() => {
            const img = document.createElement("img");
            img.src = reader.result;

            const gallery = document.createElement("div");
            gallery.classList.add("image-container");

            const delBtn = document.createElement("button");
            delBtn.innerText = "Delete";

            delBtn.addEventListener("click", () => {
              const parent = gallery.parentNode;
              parent.removeChild(gallery);
              const index = images.findIndex((image) => image.src === img.src);
              if(index != -1){
                images.splice(index, 1);
                localStorage.setItem("images", JSON.stringify(images));
              }
            });
            gallery.appendChild(img);
            gallery.appendChild(delBtn);
            galleryDiv.appendChild(gallery);

            images.push({ src: img.src});
            localStorage.setItem("images", JSON.stringify(images));
        });
        reader.readAsDataURL(file);
      }
});


images.forEach((image) => {
        const img = document.createElement("img");
        img.src = image.src;

        const gallery = document.createElement("div");
        gallery.className ="image-container";

        const delBtn = document.createElement("button");
        delBtn.className = "delete-btn";
        delBtn.innerText = "Delete";
        
        const index = images.indexOf(image);
        delBtn.addEventListener("click", () =>{
          galleryDiv.removeChild(gallery);
          images.splice(index, 1);
          localStorage.setItem("images", JSON.stringify(images));
        });
        gallery.appendChild(img);
        gallery.appendChild(delBtn);
        galleryDiv.appendChild(gallery);
      }); 
    
    </script>
  </body>
</html>